var Detector={canvas:!!window.CanvasRenderingContext2D,webgl:function(){try{var t=document.createElement("canvas");return!(!window.WebGLRenderingContext||!t.getContext("webgl")&&!t.getContext("experimental-webgl"))}catch(e){return!1}}(),workers:!!window.Worker,fileapi:window.File&&window.FileReader&&window.FileList&&window.Blob,getWebGLErrorMessage:function(){var t=document.createElement("div");return t.id="webgl-error-message",t.style.fontFamily="monospace",t.style.fontSize="13px",t.style.fontWeight="normal",t.style.textAlign="center",t.style.background="#fff",t.style.color="#000",t.style.padding="1.5em",t.style.width="400px",t.style.margin="5em auto 0",this.webgl||(t.innerHTML=window.WebGLRenderingContext?['Your graphics card does not seem to support <a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation" style="color:#000">WebGL</a>.<br />','Find out how to get it <a href="http://get.webgl.org/" style="color:#000">here</a>.'].join("\n"):['Your browser does not seem to support <a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation" style="color:#000">WebGL</a>.<br/>','Find out how to get it <a href="http://get.webgl.org/" style="color:#000">here</a>.'].join("\n")),t},addGetWebGLMessage:function(t){var e,o,n;t=t||{},e=void 0!==t.parent?t.parent:document.body,o=void 0!==t.id?t.id:"oldie",n=Detector.getWebGLErrorMessage(),n.id=o,e.appendChild(n)}};"object"==typeof module&&(module.exports=Detector);var ImprovedNoise=function(){function t(t){return t*t*t*(t*(6*t-15)+10)}function e(t,e,o){return e+t*(o-e)}function o(t,e,o,n){var i=15&t,a=8>i?e:o,r=4>i?o:12==i||14==i?e:n;return(0==(1&i)?a:-a)+(0==(2&i)?r:-r)}for(var n=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180],i=0;256>i;i++)n[256+i]=n[i];return{noise:function(i,a,r){var s=~~i,c=~~a,h=~~r,d=255&s,u=255&c,l=255&h;i-=s,a-=c,r-=h;var m=i-1,p=a-1,E=r-1,b=t(i),f=t(a),g=t(r),v=n[d]+u,y=n[v]+l,w=n[v+1]+l,T=n[d+1]+u,O=n[T]+l,R=n[T+1]+l;return e(g,e(f,e(b,o(n[y],i,a,r),o(n[O],m,a,r)),e(b,o(n[w],i,p,r),o(n[R],m,p,r))),e(f,e(b,o(n[y+1],i,a,E),o(n[O+1],m,a,r-1)),e(b,o(n[w+1],i,p,E),o(n[R+1],m,p,E))))}}};THREE.OrbitControls=function(t,e){function o(){return 2*Math.PI/60/60*p.autoRotateSpeed}function n(){return Math.pow(.95,p.zoomSpeed)}function i(t){if(p.enabled!==!1){if(t.preventDefault(),t.button===p.mouseButtons.ORBIT){if(p.noRotate===!0)return;C=A.ROTATE,b.set(t.clientX,t.clientY)}else if(t.button===p.mouseButtons.ZOOM){if(p.noZoom===!0)return;C=A.DOLLY,R.set(t.clientX,t.clientY)}else if(t.button===p.mouseButtons.PAN){if(p.noPan===!0)return;C=A.PAN,v.set(t.clientX,t.clientY)}C!==A.NONE&&(document.addEventListener("mousemove",a,!1),document.addEventListener("mouseup",r,!1),p.dispatchEvent(z))}}function a(t){if(p.enabled!==!1){t.preventDefault();var e=p.domElement===document?p.domElement.body:p.domElement;if(C===A.ROTATE){if(p.noRotate===!0)return;f.set(t.clientX,t.clientY),g.subVectors(f,b),p.rotateLeft(2*Math.PI*g.x/e.clientWidth*p.rotateSpeed),p.rotateUp(2*Math.PI*g.y/e.clientHeight*p.rotateSpeed),b.copy(f)}else if(C===A.DOLLY){if(p.noZoom===!0)return;M.set(t.clientX,t.clientY),H.subVectors(M,R),H.y>0?p.dollyIn():H.y<0&&p.dollyOut(),R.copy(M)}else if(C===A.PAN){if(p.noPan===!0)return;y.set(t.clientX,t.clientY),w.subVectors(y,v),p.pan(w.x,w.y),v.copy(y)}C!==A.NONE&&p.update()}}function r(){p.enabled!==!1&&(document.removeEventListener("mousemove",a,!1),document.removeEventListener("mouseup",r,!1),p.dispatchEvent(V),C=A.NONE)}function s(t){if(p.enabled!==!1&&p.noZoom!==!0&&C===A.NONE){t.preventDefault(),t.stopPropagation();var e=0;void 0!==t.wheelDelta?e=t.wheelDelta:void 0!==t.detail&&(e=-t.detail),e>0?p.dollyOut():0>e&&p.dollyIn(),p.update(),p.dispatchEvent(z),p.dispatchEvent(V)}}function c(t){if(p.enabled!==!1&&p.noKeys!==!0&&p.noPan!==!0)switch(t.keyCode){case p.keys.UP:p.pan(0,p.keyPanSpeed),p.update();break;case p.keys.BOTTOM:p.pan(0,-p.keyPanSpeed),p.update();break;case p.keys.LEFT:p.pan(p.keyPanSpeed,0),p.update();break;case p.keys.RIGHT:p.pan(-p.keyPanSpeed,0),p.update()}}function h(t){if(p.enabled!==!1){switch(t.touches.length){case 1:if(p.noRotate===!0)return;C=A.TOUCH_ROTATE,b.set(t.touches[0].pageX,t.touches[0].pageY);break;case 2:if(p.noZoom===!0)return;C=A.TOUCH_DOLLY;var e=t.touches[0].pageX-t.touches[1].pageX,o=t.touches[0].pageY-t.touches[1].pageY,n=Math.sqrt(e*e+o*o);R.set(0,n);break;case 3:if(p.noPan===!0)return;C=A.TOUCH_PAN,v.set(t.touches[0].pageX,t.touches[0].pageY);break;default:C=A.NONE}C!==A.NONE&&p.dispatchEvent(z)}}function d(t){if(p.enabled!==!1){t.preventDefault(),t.stopPropagation();var e=p.domElement===document?p.domElement.body:p.domElement;switch(t.touches.length){case 1:if(p.noRotate===!0)return;if(C!==A.TOUCH_ROTATE)return;f.set(t.touches[0].pageX,t.touches[0].pageY),g.subVectors(f,b),p.rotateLeft(2*Math.PI*g.x/e.clientWidth*p.rotateSpeed),p.rotateUp(2*Math.PI*g.y/e.clientHeight*p.rotateSpeed),b.copy(f),p.update();break;case 2:if(p.noZoom===!0)return;if(C!==A.TOUCH_DOLLY)return;var o=t.touches[0].pageX-t.touches[1].pageX,n=t.touches[0].pageY-t.touches[1].pageY,i=Math.sqrt(o*o+n*n);M.set(0,i),H.subVectors(M,R),H.y>0?p.dollyOut():H.y<0&&p.dollyIn(),R.copy(M),p.update();break;case 3:if(p.noPan===!0)return;if(C!==A.TOUCH_PAN)return;y.set(t.touches[0].pageX,t.touches[0].pageY),w.subVectors(y,v),p.pan(w.x,w.y),v.copy(y),p.update();break;default:C=A.NONE}}}function u(){p.enabled!==!1&&(p.dispatchEvent(V),C=A.NONE)}this.object=t,this.domElement=void 0!==e?e:document,this.enabled=!0,this.target=new THREE.Vector3,this.center=this.target,this.noZoom=!1,this.zoomSpeed=1,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.noRotate=!1,this.rotateSpeed=1,this.noPan=!1,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-(1/0),this.maxAzimuthAngle=1/0,this.noKeys=!1,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={ORBIT:THREE.MOUSE.LEFT,ZOOM:THREE.MOUSE.MIDDLE,PAN:THREE.MOUSE.RIGHT};var l,m,p=this,E=1e-6,b=new THREE.Vector2,f=new THREE.Vector2,g=new THREE.Vector2,v=new THREE.Vector2,y=new THREE.Vector2,w=new THREE.Vector2,T=new THREE.Vector3,O=new THREE.Vector3,R=new THREE.Vector2,M=new THREE.Vector2,H=new THREE.Vector2,L=0,j=0,x=1,P=new THREE.Vector3,N=new THREE.Vector3,k=new THREE.Quaternion,A={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5},C=A.NONE;this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom;var D=(new THREE.Quaternion).setFromUnitVectors(t.up,new THREE.Vector3(0,1,0)),Y=D.clone().inverse(),I={type:"change"},z={type:"start"},V={type:"end"};this.rotateLeft=function(t){void 0===t&&(t=o()),j-=t},this.rotateUp=function(t){void 0===t&&(t=o()),L-=t},this.panLeft=function(t){var e=this.object.matrix.elements;T.set(e[0],e[1],e[2]),T.multiplyScalar(-t),P.add(T)},this.panUp=function(t){var e=this.object.matrix.elements;T.set(e[4],e[5],e[6]),T.multiplyScalar(t),P.add(T)},this.pan=function(t,e){var o=p.domElement===document?p.domElement.body:p.domElement;if(p.object instanceof THREE.PerspectiveCamera){var n=p.object.position,i=n.clone().sub(p.target),a=i.length();a*=Math.tan(p.object.fov/2*Math.PI/180),p.panLeft(2*t*a/o.clientHeight),p.panUp(2*e*a/o.clientHeight)}else p.object instanceof THREE.OrthographicCamera?(p.panLeft(t*(p.object.right-p.object.left)/o.clientWidth),p.panUp(e*(p.object.top-p.object.bottom)/o.clientHeight)):console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.")},this.dollyIn=function(t){void 0===t&&(t=n()),p.object instanceof THREE.PerspectiveCamera?x/=t:p.object instanceof THREE.OrthographicCamera?(p.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom*t)),p.object.updateProjectionMatrix(),p.dispatchEvent(I)):console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.")},this.dollyOut=function(t){void 0===t&&(t=n()),p.object instanceof THREE.PerspectiveCamera?x*=t:p.object instanceof THREE.OrthographicCamera?(p.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/t)),p.object.updateProjectionMatrix(),p.dispatchEvent(I)):console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.")},this.update=function(){var t=this.object.position;O.copy(t).sub(this.target),O.applyQuaternion(D),l=Math.atan2(O.x,O.z),m=Math.atan2(Math.sqrt(O.x*O.x+O.z*O.z),O.y),this.autoRotate&&C===A.NONE&&this.rotateLeft(o()),l+=j,m+=L,l=Math.max(this.minAzimuthAngle,Math.min(this.maxAzimuthAngle,l)),m=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,m)),m=Math.max(E,Math.min(Math.PI-E,m));var e=O.length()*x;e=Math.max(this.minDistance,Math.min(this.maxDistance,e)),this.target.add(P),O.x=e*Math.sin(m)*Math.sin(l),O.y=e*Math.cos(m),O.z=e*Math.sin(m)*Math.cos(l),O.applyQuaternion(Y),t.copy(this.target).add(O),this.object.lookAt(this.target),j=0,L=0,x=1,P.set(0,0,0),(N.distanceToSquared(this.object.position)>E||8*(1-k.dot(this.object.quaternion))>E)&&(this.dispatchEvent(I),N.copy(this.object.position),k.copy(this.object.quaternion))},this.reset=function(){C=A.NONE,this.target.copy(this.target0),this.object.position.copy(this.position0),this.object.zoom=this.zoom0,this.object.updateProjectionMatrix(),this.dispatchEvent(I),this.update()},this.getPolarAngle=function(){return m},this.getAzimuthalAngle=function(){return l},this.domElement.addEventListener("contextmenu",function(t){t.preventDefault()},!1),this.domElement.addEventListener("mousedown",i,!1),this.domElement.addEventListener("mousewheel",s,!1),this.domElement.addEventListener("DOMMouseScroll",s,!1),this.domElement.addEventListener("touchstart",h,!1),this.domElement.addEventListener("touchend",u,!1),this.domElement.addEventListener("touchmove",d,!1),window.addEventListener("keydown",c,!1),this.update()},THREE.OrbitControls.prototype=Object.create(THREE.EventDispatcher.prototype),THREE.OrbitControls.prototype.constructor=THREE.OrbitControls,THREE.PointerLockControls=function(t){var e=this;t.rotation.set(0,0,0);var o=new THREE.Object3D;o.add(t);var n=new THREE.Object3D;n.position.y=10,n.add(o);var i=Math.PI/2,a=function(t){if(e.enabled!==!1){var a=t.movementX||t.mozMovementX||t.webkitMovementX||0,r=t.movementY||t.mozMovementY||t.webkitMovementY||0;n.rotation.y-=.002*a,o.rotation.x-=.002*r,o.rotation.x=Math.max(-i,Math.min(i,o.rotation.x))}};document.addEventListener("mousemove",a,!1),this.enabled=!1,this.getObject=function(){return n},this.getDirection=function(){var t=new THREE.Vector3(0,0,-1),e=new THREE.Euler(0,0,0,"YXZ");return function(i){return e.set(o.rotation.x,n.rotation.y,0),i.copy(t).applyEuler(e),i}}()};