!function t(e,n,r){function i(s,u){if(!n[s]){if(!e[s]){var c="function"==typeof require&&require;if(!u&&c)return c(s,!0);if(o)return o(s,!0);var a=new Error("Cannot find module '"+s+"'");throw a.code="MODULE_NOT_FOUND",a}var l=n[s]={exports:{}};e[s][0].call(l.exports,function(t){var n=e[s][1][t];return i(n?n:t)},l,l.exports,t,e,n,r)}return n[s].exports}for(var o="function"==typeof require&&require,s=0;s<r.length;s++)i(r[s]);return i}({1:[function(t,e,n){"function"==typeof Object.create?e.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},{}],2:[function(t,e,n){function r(){l=!1,u.length?a=u.concat(a):h=-1,a.length&&i()}function i(){if(!l){var t=setTimeout(r);l=!0;for(var e=a.length;e;){for(u=a,a=[];++h<e;)u[h].run();h=-1,e=a.length}u=null,l=!1,clearTimeout(t)}}function o(t,e){this.fun=t,this.array=e}function s(){}var u,c=e.exports={},a=[],l=!1,h=-1;c.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];a.push(new o(t,e)),1!==a.length||l||setTimeout(i,0)},o.prototype.run=function(){this.fun.apply(null,this.array)},c.title="browser",c.browser=!0,c.env={},c.argv=[],c.version="",c.versions={},c.on=s,c.addListener=s,c.once=s,c.off=s,c.removeListener=s,c.removeAllListeners=s,c.emit=s,c.binding=function(t){throw new Error("process.binding is not supported")},c.cwd=function(){return"/"},c.chdir=function(t){throw new Error("process.chdir is not supported")},c.umask=function(){return 0}},{}],3:[function(t,e,n){e.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},{}],4:[function(t,e,n){(function(e,r){function i(t,e){var r={seen:[],stylize:s};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),y(e)?r.showHidden=e:e&&n._extend(r,e),b(r.showHidden)&&(r.showHidden=!1),b(r.depth)&&(r.depth=2),b(r.colors)&&(r.colors=!1),b(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=o),c(r,t,r.depth)}function o(t,e){var n=i.styles[e];return n?"["+i.colors[n][0]+"m"+t+"["+i.colors[n][1]+"m":t}function s(t,e){return t}function u(t){var e={};return t.forEach(function(t,n){e[t]=!0}),e}function c(t,e,r){if(t.customInspect&&e&&R(e.inspect)&&e.inspect!==n.inspect&&(!e.constructor||e.constructor.prototype!==e)){var i=e.inspect(r,t);return E(i)||(i=c(t,i,r)),i}var o=a(t,e);if(o)return o;var s=Object.keys(e),y=u(s);if(t.showHidden&&(s=Object.getOwnPropertyNames(e)),T(e)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return l(e);if(0===s.length){if(R(e)){var g=e.name?": "+e.name:"";return t.stylize("[Function"+g+"]","special")}if(z(e))return t.stylize(RegExp.prototype.toString.call(e),"regexp");if(M(e))return t.stylize(Date.prototype.toString.call(e),"date");if(T(e))return l(e)}var m="",v=!1,w=["{","}"];if(d(e)&&(v=!0,w=["[","]"]),R(e)){var b=e.name?": "+e.name:"";m=" [Function"+b+"]"}if(z(e)&&(m=" "+RegExp.prototype.toString.call(e)),M(e)&&(m=" "+Date.prototype.toUTCString.call(e)),T(e)&&(m=" "+l(e)),0===s.length&&(!v||0==e.length))return w[0]+m+w[1];if(0>r)return z(e)?t.stylize(RegExp.prototype.toString.call(e),"regexp"):t.stylize("[Object]","special");t.seen.push(e);var x;return x=v?h(t,e,r,y,s):s.map(function(n){return f(t,e,r,y,n,v)}),t.seen.pop(),p(x,m,w)}function a(t,e){if(b(e))return t.stylize("undefined","undefined");if(E(e)){var n="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(n,"string")}return v(e)?t.stylize(""+e,"number"):y(e)?t.stylize(""+e,"boolean"):g(e)?t.stylize("null","null"):void 0}function l(t){return"["+Error.prototype.toString.call(t)+"]"}function h(t,e,n,r,i){for(var o=[],s=0,u=e.length;u>s;++s)S(e,String(s))?o.push(f(t,e,n,r,String(s),!0)):o.push("");return i.forEach(function(i){i.match(/^\d+$/)||o.push(f(t,e,n,r,i,!0))}),o}function f(t,e,n,r,i,o){var s,u,a;if(a=Object.getOwnPropertyDescriptor(e,i)||{value:e[i]},a.get?u=a.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):a.set&&(u=t.stylize("[Setter]","special")),S(r,i)||(s="["+i+"]"),u||(t.seen.indexOf(a.value)<0?(u=g(n)?c(t,a.value,null):c(t,a.value,n-1),u.indexOf("\n")>-1&&(u=o?u.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+u.split("\n").map(function(t){return"   "+t}).join("\n"))):u=t.stylize("[Circular]","special")),b(s)){if(o&&i.match(/^\d+$/))return u;s=JSON.stringify(""+i),s.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=t.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=t.stylize(s,"string"))}return s+": "+u}function p(t,e,n){var r=0,i=t.reduce(function(t,e){return r++,e.indexOf("\n")>=0&&r++,t+e.replace(/\u001b\[\d\d?m/g,"").length+1},0);return i>60?n[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+n[1]:n[0]+e+" "+t.join(", ")+" "+n[1]}function d(t){return Array.isArray(t)}function y(t){return"boolean"==typeof t}function g(t){return null===t}function m(t){return null==t}function v(t){return"number"==typeof t}function E(t){return"string"==typeof t}function w(t){return"symbol"==typeof t}function b(t){return void 0===t}function z(t){return x(t)&&"[object RegExp]"===k(t)}function x(t){return"object"==typeof t&&null!==t}function M(t){return x(t)&&"[object Date]"===k(t)}function T(t){return x(t)&&("[object Error]"===k(t)||t instanceof Error)}function R(t){return"function"==typeof t}function H(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||"undefined"==typeof t}function k(t){return Object.prototype.toString.call(t)}function C(t){return 10>t?"0"+t.toString(10):t.toString(10)}function O(){var t=new Date,e=[C(t.getHours()),C(t.getMinutes()),C(t.getSeconds())].join(":");return[t.getDate(),j[t.getMonth()],e].join(" ")}function S(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var _=/%[sdj%]/g;n.format=function(t){if(!E(t)){for(var e=[],n=0;n<arguments.length;n++)e.push(i(arguments[n]));return e.join(" ")}for(var n=1,r=arguments,o=r.length,s=String(t).replace(_,function(t){if("%%"===t)return"%";if(n>=o)return t;switch(t){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(e){return"[Circular]"}default:return t}}),u=r[n];o>n;u=r[++n])s+=g(u)||!x(u)?" "+u:" "+i(u);return s},n.deprecate=function(t,i){function o(){if(!s){if(e.throwDeprecation)throw new Error(i);e.traceDeprecation?console.trace(i):console.error(i),s=!0}return t.apply(this,arguments)}if(b(r.process))return function(){return n.deprecate(t,i).apply(this,arguments)};if(e.noDeprecation===!0)return t;var s=!1;return o};var A,D={};n.debuglog=function(t){if(b(A)&&(A=e.env.NODE_DEBUG||""),t=t.toUpperCase(),!D[t])if(new RegExp("\\b"+t+"\\b","i").test(A)){var r=e.pid;D[t]=function(){var e=n.format.apply(n,arguments);console.error("%s %d: %s",t,r,e)}}else D[t]=function(){};return D[t]},n.inspect=i,i.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},i.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"},n.isArray=d,n.isBoolean=y,n.isNull=g,n.isNullOrUndefined=m,n.isNumber=v,n.isString=E,n.isSymbol=w,n.isUndefined=b,n.isRegExp=z,n.isObject=x,n.isDate=M,n.isError=T,n.isFunction=R,n.isPrimitive=H,n.isBuffer=t("./support/isBuffer");var j=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];n.log=function(){console.log("%s - %s",O(),n.format.apply(n,arguments))},n.inherits=t("inherits"),n._extend=function(t,e){if(!e||!x(e))return t;for(var n=Object.keys(e),r=n.length;r--;)t[n[r]]=e[n[r]];return t}}).call(this,t("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":3,_process:2,inherits:1}],5:[function(t,e,n){var r,i=[].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1},o={}.hasOwnProperty;r=function(){function t(t){var e,n,r,s,u,c,a,l,h;this.domElement=null!=t?t:document,this.keys={},this.listener={},this.keyMap={8:"backspace",13:"enter",16:"shift",17:"ctrl",18:"alt",27:"esc",32:"space",37:"left",38:"up",39:"right",40:"down"},s=function(t){return function(e,n){return{key:t.keyMap[e]||String.fromCharCode(e).toLowerCase(),status:n}}}(this),n=Bacon.fromEventTarget(this.domElement,"keydown").map(function(t){return function(e){return s.call(t,e.keyCode,!0)}}(this)),r=Bacon.fromEventTarget(this.domElement,"keyup").map(function(t){return function(e){return s.call(t,e.keyCode,!1)}}(this)),n.merge(r).filter(function(t){var e;return e=t.key.charCodeAt(0),e>47&&58>e||e>96&&123>e}).onValue(function(t){return function(e){var n;return t.keys[e.key]=e.status,e.status&&null!=(n=t.listener[e.key])?n.forEach(function(t){return t()}):void 0}}(this)),e=[THREE.MOUSE.LEFT,THREE.MOUSE.RIGHT],u=function(t){return function(n){var r;return r={},e.forEach(function(t){return r[t]=[]}),Bacon.fromEventTarget(t.domElement,n).filter(function(t){var n;return n=t.button,i.call(e,n)>=0}).onValue(function(t){return r[t.button].forEach(function(e){return e(t.clientX,t.clientY)})}),[function(t,e){var n;return null!=(n=r[t])?n.push(e):void 0},function(t,e){return _.remove(r[t],function(t){return null!=e?t===e:!0})}]}}(this),c=u("mousedown"),this.onMouseDown=c[0],this.offMouseDown=c[1],a=u("mouseup"),this.onMouseUp=a[0],this.offMouseUp=a[1],l=_.transform(u("dblclick"),function(t,e){return t.push(e.bind(this,THREE.MOUSE.LEFT))}),this.onDoubleClick=l[0],this.offDoubleClick=l[1],h=function(t){return function(){var n,r,i,s;return r={},n={},e.forEach(function(t){return n[t]=!1,r[t]=[]}),i=Bacon.fromEventTarget(t.domElement,"mousedown").map(function(t){return[t.button,!0]}),s=Bacon.fromEventTarget(t.domElement,"mouseup").map(function(t){return[t.button,!1]}),i.merge(s).onValue(function(t){return null!=n[t[0]]?n[t[0]]=t[1]:void 0}),Bacon.fromEventTarget(t.domElement,"mousemove").onValue(function(t){var e,i,s;i=[];for(e in r)o.call(r,e)&&(s=r[e],i.push(s.forEach(function(r){return n[e]?r(t.clientX,t.clientY):void 0})));return i}),[function(t,e){var n;return null!=(n=r[t])?n.push(e):void 0},function(t,e){return _.remove(r[t],function(t){return null!=e?t===e:!0})}]}}(this)(),this.onMouseMove=h[0],this.offMouseMove=h[1],this.offAll=function(t){return function(){var n,r,i,s;e.forEach(function(e){return t.offMouseDown(e),t.offMouseUp(e),t.offMouseMove(e)}),t.offDoubleClick(),r=t.listener,i=[];for(n in r)o.call(r,n)&&(s=r[n],i.push(t.off(n)));return i}}(this)}return t.prototype.on=function(t,e){return this.listener[t]?this.listener[t].push(e):this.listener[t]=[e]},t.prototype.off=function(t,e){return null==e&&(e=allremove),_.remove(this.listener[t],function(t){return t===e})},t}(),e.exports=r},{}],6:[function(t,e,n){"use strict";var r,i;i=t("./scene"),r=function(){function t(){var t;Detector.webgl||Detector.addGetWebGLMessage(),this.renderer=new THREE.WebGLRenderer({alpha:!0,antialiasing:!0}),this.renderer.setSize(window.innerWidth,window.innerHeight),this.renderer.setClearColor(10541295,1),this.renderer.autoClear=!1,this.renderer.sortObjects=!0,$("#world").append(this.renderer.domElement),this.currentScene=void 0,t=function(t){return function(e){return t.currentScene.input.offAll(),t.currentScene=e}}(this),this.currentScene=new i(this.renderer,t),this.stats=new Stats,this.stats.setMode(0),this.stats.domElement.style.position="absolute",this.stats.domElement.style.left="0px",this.stats.domElement.style.top="0px",$(document.body).append(this.stats.domElement),$(window).resize(function(t){return function(){var e,n;return n=window.innerWidth,e=window.innerHeight,t.renderer.setSize(n,e),t.currentScene.camera.aspect=n/e,t.currentScene.camera.updateProjectionMatrix()}}(this))}return t.prototype.animate=function(){var t;return requestAnimationFrame(function(t){return function(){return t.animate()}}(this)),this.stats.begin(),this.renderer.clear(),null!=(t=this.currentScene)&&t.update(),this.stats.end()},t}(),$(function(){return(new r).animate()})},{"./scene":8}],7:[function(t,e,n){var r,i,o,s=function(t,e){function n(){this.constructor=t}for(var r in e)u.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},u={}.hasOwnProperty;r=t("./input"),o=t("util").inspect,i=function(t){function e(t,n,i,o){this.world=t,e.__super__.constructor.call(this),this.input=new r,this.velocity=new THREE.Vector3(0,0,0),this.canJump=!1,this.canDoubleJump=!1,this.doubleJumpFlag=!1,this.gravity=!0,this.height=1.7,this.width=.7,this.mode=1,this.sneak=!1,this.position.set(n,i,o),this.lookAt(new THREE.Vector3(n,0,o)),this.ray=new THREE.Raycaster,this.ray.near=0,this.ray.far=4}return s(e,t),e.prototype.getCollider=function(){return this.collider=[this.position.clone().add(new THREE.Vector3(-this.width/2,-.5,-this.width/2)),this.position.clone().add(new THREE.Vector3(this.width/2,this.height-.5,this.width/2))]},e.prototype.getCell=function(){var t;return t={x:Math.floor(this.position.x),y:Math.floor(this.position.y),z:Math.floor(this.position.z)}},e.prototype.getAroundColliders=function(t,e){var n,r,i,o,s,u,c,a,l,h,f,p,d,y,g,m,v,E,w,b;for(y=[],f=this.getCell(),E=f.x,w=f.y,b=f.z,o=[],p=[-1,0,1],s=0,a=p.length;a>s;s++)for(n=p[s],d=[-1,0,1],u=0,l=d.length;l>u;u++)r=d[u],"x"===t&&o.push([e,n,r]),"y"===t&&o.push([n,e,r]),"z"===t&&o.push([n,r,e]);for(c=0,h=o.length;h>c;c++)i=o[c],g=E+i[0],m=w+i[1],v=b+i[2],this.world.terrain.getType(g,m,v)&&y.push(this.world.terrain.getCollider(g,m,v));return y},e.prototype.collides=function(t){var e;return e=this.getCollider(),t.some(function(t){return t[0].x>e[1].x?!1:t[0].y>e[1].y?!1:t[0].z>e[1].z?!1:t[1].x<e[0].x?!1:t[1].y<e[0].y?!1:t[1].z<e[0].z?!1:!0})},e.prototype.update=function(t){var e,n,r,i,o,s,u,c,a,l,h,f,p,d,y,g,m;if(i=!1,r=.001,this.velocity.x-=3*this.velocity.x*t,this.velocity.z-=3*this.velocity.z*t,Math.abs(this.velocity.x)<r&&(this.velocity.x=0),Math.abs(this.velocity.z)<r&&(this.velocity.z=0),this.gravity&&(this.velocity.y-=9.8*2.7*t),this.input.keys.shift?this.canJump&&(this.sneak=!0):(i=!0,this.sneak=!1),m=this.sneak?2:12,this.input.keys.w&&(this.velocity.z-=m*t,i=!0),this.input.keys.a&&(this.velocity.x-=m*t,i=!0),this.input.keys.s&&(this.velocity.z+=m*t,i=!0),this.input.keys.d&&(this.velocity.x+=m*t,i=!0),this.input.keys.space&&!this.sneak?this.gravity?this.canDoubleJump&&(this.velocity.y=17,this.velocity.x*=3,this.velocity.z*=3,this.canDoubleJump=!1):this.canJump&&(this.velocity.y=8.5,this.canJump=!1,this.gravity=!0,this.doubleJumpFlag=!0):this.doubleJumpFlag&&(this.canDoubleJump=!0,this.doubleJumpFlag=!1),i&&(this.gravity=!0,this.canJump=!1),p=this.position.clone(),this.translateX(this.velocity.x*t),this.translateZ(this.velocity.z*t),this.translateY(this.velocity.y*t),l={x:this.position.x-p.x,z:this.position.z-p.z,y:this.position.y-p.y},this.position.copy(p),this.sneak){for(d=["x","z"],o=0,u=d.length;u>o;o++)if(e=d[o],a=l[e],!(Math.abs(a)<r))if(h=this.position[e],this.position[e]+=a,n=this.getAroundColliders(e,0>a?-1:1),this.collides(n))this.position[e]=h;else{if(l.y>0)continue;f=this.position.y,this.position.y-=.5,n=this.getAroundColliders("y",-1),this.collides(n)||(this.position[e]=h),this.position.y=f}return this.velocity.y=0,this.gravity=!1}for(y=["x","z","y"],g=[],s=0,c=y.length;c>s;s++)e=y[s],a=l[e],Math.abs(a)<r||(h=this.position[e],this.position[e]+=a,n=this.getAroundColliders(e,0>a?-1:1),this.collides(n)?(this.position[e]=h,"y"===e?(this.velocity.y=0,0>a?(this.canJump=!0,this.canDoubleJump=!1,this.doubleJumpFlag=!1,g.push(this.gravity=!1)):g.push(void 0)):g.push(void 0)):g.push(void 0));return g},e}(THREE.Object3D),e.exports=i},{"./input":5,util:4}],8:[function(t,e,n){var r,i,o,s,u=function(t,e){function n(){this.constructor=t}for(var r in e)c.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},c={}.hasOwnProperty;r=t("./input"),s=t("./world"),o=function(){function t(t,e){var n,i;this.renderer=t,this.transit=e,this.clock=new THREE.Clock,this.input=new r(document.body),this.scene=new THREE.Scene,i=window.innerWidth,n=window.innerHeight,this.camera=new THREE.PerspectiveCamera(72,i/n,.1,1e3)}return t.prototype.update=function(){return this.renderer.render(this.scene,this.camera)},t}(),i=function(t){function e(t,n){this.renderer=t,this.transit=n,e.__super__.constructor.call(this,this.renderer,this.transit),this.scene.fog=new THREE.Fog(16777215,100,1e3),this.controls=new THREE.PointerLockControls(this.camera),this.scene.add(this.controls.getObject()),this.world=new s(this.scene,128),this.world.syncCamera(this.controls),this.input.onMouseDown(THREE.MOUSE.LEFT,function(t){return function(){return document.pointerLockElement?void 0:(t.controls.enabled=!0,document.body.requestPointerLock())}}(this)),this.input.onDoubleClick(function(t){return function(){return document.pointerLockElement?(t.controls.enabled=!1,document.exitPointerLock()):void 0}}(this))}return u(e,t),e.prototype.update=function(){return this.controls.enabled&&(this.world.update(this.clock.getDelta()),this.world.syncCamera(this.controls)),e.__super__.update.call(this)},e}(o),e.exports=i},{"./input":5,"./world":11}],9:[function(t,e,n){var r,i;i=t("./util"),r=function(){function t(t,e,n,r){this.size=t,this.heightMin=null!=e?e:0,this.heightRange=null!=n?n:128,this.seed=null!=r?r:void 0,this.size2=this.size*this.size,null==this.seed&&(this.seed=i.rand(1e6)),this.cell=new Uint8Array(this.size2*this.heightRange),this.generateMesh(32,.5,this.heightMin,this.heightMin+this.heightRange-1),console.log("seed: "+this.seed)}return t.prototype.getType=function(t,e,n){return 0>t||t>this.size-1?0:0>n||n>this.size-1?0:e<this.heightMin||e>this.heightMin+this.heightRange-1?0:this.cell[t+n*this.size+e*this.size2]},t.prototype.getColor=function(t){var e,n,r,i;switch(e=new THREE.Color(0),i=new THREE.Color(1118481),n=new THREE.Color(9127187),r=new THREE.Color(2263842),t){case 0:return[e,e,e,e,e,e];case 1:return[n,n,n,n,n,n];case 2:return[r,n,n,n,n,n];default:return[i,i,i,i,i,i]}},t.prototype.getCollider=function(t,e,n){return[new THREE.Vector3(t,e,n),new THREE.Vector3(t+1,e+1,n+1)]},t.prototype.getHeight=function(t,e){var n,r,i,o,s,u;for(i=t+e*this.size,r=this.heightMin+this.heightRange-1,n=o=s=r,u=this.heightMin;u>=s?u>=o:o>=u;n=u>=s?++o:--o)if(0!==this.cell[i+n*this.size2])return n;return this.heightMin},t.prototype.generateMesh=function(t,e,n,r){var o;return o=new Int16Array(this.size*this.size),function(s){return function(){var u,c,a,l,h,f,p,d,y,g,m,v,E;for(u=n,c=r,a=f=0,g=s.size2;g>=0?g>f:f>g;a=g>=0?++f:--f){for(v=(a%s.size+2)/2,E=((a/s.size|0)+3)/2,y=2,h=p=0;4>p;h=++p)o[a]+=i.noise(v/y,E/y,s.seed)*y,y*=4;for(o[a]=~~Math.max(n,Math.min(r,o[a]*e+t)),l=d=0,m=o[a];m>=0?m>=d:d>=m;l=m>=0?++d:--d)l===o[a]?s.cell[a+l*s.size2]=2:s.cell[a+l*s.size2]=1;u=Math.max(u,o[a]),c=Math.min(c,o[a])}return console.log("height: ["+c+", "+u+"]")}}(this)(),this.geometry=new THREE.BufferGeometry,this.material=new THREE.MeshLambertMaterial({vertexColors:THREE.VertexColors}),function(t){return function(){var e,n,r,o,s,u,c,a,l,h;return s=[[[0,1,0],[0,1,1],[1,1,0],[1,1,1]],[[0,1,0],[0,0,0],[0,1,1],[0,0,1]],[[1,1,1],[1,0,1],[1,1,0],[1,0,0]],[[1,1,0],[1,0,0],[0,1,0],[0,0,0]],[[0,1,1],[0,0,1],[1,1,1],[1,0,1]],[[1,0,1],[0,0,1],[1,0,0],[0,0,0]]],u=[[0,1,2],[2,1,3]],r=[[0,1,0],[-1,0,0],[1,0,0],[0,0,-1],[0,0,1],[0,-1,0]],o=0,function(){return t.cell.forEach(function(e,n){var i,s,u;if(0!==e)return i=n%t.size,u=n%t.size2/t.size|0,s=n/t.size2|0,r.forEach(function(e){var n;return n=t.getType(i+e[0],s+e[1],u+e[2]),0===n?o++:void 0})})}(),console.log("faceNum: "+o),h=new Float32Array(4*o*3),c=new Uint32Array(2*o*3),a=new Float32Array(4*o*3),e=new Float32Array(4*o*3),n=0,l=1e-5,t.cell.forEach(function(o,f){var p,d,y,g;if(0!==o)return d=f%t.size,g=f%t.size2/t.size|0,y=f/t.size2|0,p=t.getColor(t.getType(d,y,g)),r.forEach(function(r,o){var f;return f=t.getType(d+r[0],y+r[1],g+r[2]),0===f?(s[o].forEach(function(t,r){var s;return h[12*n+3*r+0]=t[0]+d+(t[0]<.5?l:-l),h[12*n+3*r+1]=t[1]+y+(t[1]<.5?l:-l),h[12*n+3*r+2]=t[2]+g+(t[2]<.5?l:-l),a[12*n+3*r+0]=1===o?-1:2===o?1:0,a[12*n+3*r+1]=5===o?-1:0===o?1:0,a[12*n+3*r+2]=3===o?-1:4===o?1:0,s=p[o],e[12*n+3*r+0]=s.r+i.randf(s.r/8),e[12*n+3*r+1]=s.g+i.randf(s.r/8),e[12*n+3*r+2]=s.b+i.randf(s.r/8)}),u.forEach(function(t,e){return c[6*n+3*e+0]=t[0]+4*n,c[6*n+3*e+1]=t[1]+4*n,c[6*n+3*e+2]=t[2]+4*n}),n++):void 0})}),t.geometry.addAttribute("position",new THREE.BufferAttribute(h,3)),t.geometry.addAttribute("index",new THREE.BufferAttribute(c,3)),t.geometry.addAttribute("normal",new THREE.BufferAttribute(a,3)),t.geometry.addAttribute("color",new THREE.BufferAttribute(e,3))}}(this)(),this.mesh=new THREE.Mesh(this.geometry,this.material)},t}(),e.exports=r},{"./util":10}],10:[function(t,e,n){var r;r=function(){function t(){}return t.rand=function(t){return Math.floor(Math.random()*t)},t.randf=function(t){return Math.random()*t},t.randRange=function(t,e){return Math.floor(Math.random()*(e-t+1))+t},t.randArray=function(t){return t[Math.floor(Math.random()*t.length)]},t.noise=function(){var t;return t=new ImprovedNoise,function(e,n,r){return t.noise(e,n,r)}}(),t}(),e.exports=r},{}],11:[function(t,e,n){var r,i,o;i=t("./terrain"),r=t("./player"),o=function(){function t(t,e){var n;this.scene=t,this.size=e,n=128,this.terrain=new i(this.size,0,n),this.scene.add(this.terrain.mesh),this.light=new THREE.DirectionalLight(16777215,.6),this.light.position.set(.5,.7,.3).normalize(),this.scene.add(this.light),this.light2=new THREE.HemisphereLight(16777215,1118481,.6),this.scene.add(this.light2),this.player=new r(this,this.size/2,this.terrain.getHeight(this.size/2,this.size/2)+3,this.size/2)}return t.prototype.update=function(t){return this.player.update(t)},t.prototype.syncCamera=function(t){var e;return e=this.player.position.clone().add(new THREE.Vector3(0,this.player.height-.6,0)),t.getObject().position.copy(e),this.player.rotation.copy(t.getObject().rotation)},t}(),e.exports=o},{"./player":7,"./terrain":9}]},{},[6]);
//# sourceMappingURL=bundle.js.map