{"version":3,"sources":["node_modules/browserify/node_modules/browser-pack/_prelude.js","src/input.coffee","bundle.js","src/main.coffee","src/scene.coffee","src/util.coffee"],"names":["e","t","n","r","s","o","u","a","require","i","f","Error","code","l","exports","call","length",1,"module","Input","indexOf","item","this","hasProp","hasOwnProperty","domElement","buttons","keydown","keyup","mapper","mouseEvent","ref","ref1","ref2","ref3","document","keys","listener","keyMap",8,13,16,17,18,27,32,37,38,39,40,"_this","keycode","status","key","String","fromCharCode","toLowerCase","Bacon","fromEventTarget","map","keyCode","merge","filter","charCodeAt","onValue","forEach","v","THREE","MOUSE","LEFT","RIGHT","type","button","clientX","clientY","btn","cb","push","_","remove","onMouseDown","offMouseDown","onMouseUp","offMouseUp","transform","res","bind","onDoubleClick","offDoubleClick","active","md","mu","k","results","onMouseMove","offMouseMove","offAll","ref4","off","prototype","on","allremove",2,"Main","Scene","transit","Detector","webgl","addGetWebGLMessage","renderer","WebGLRenderer","alpha","antialiasing","setSize","window","innerWidth","innerHeight","setClearColor","autoClear","sortObjects","$","append","currentScene","input","stats","Stats","setMode","style","position","left","top","body","resize","height","width","camera","aspect","updateProjectionMatrix","animate","requestAnimationFrame","begin","clear","update","end","./scene",3,"OrbitScene","PLScene","util","extend","child","parent","ctor","constructor","__super__","clock","Clock","scene","PerspectiveCamera","render","superClass","bgeometry","bmaterial","bmesh","geometry","hash","hmax","hmin","material","max","min","points","range","results1","size2","values","vertexIndex","vlist","z","controls","OrbitControls","SIZE","rand","quality","size","apply","m","x","noise","console","log","j","value","y","Vector3","Array","Geometry","bits","cubeindex","face","index1","index2","index3","isolevel","p","px","pxy","pxyz","pxz","py","pyz","pz","value0","value1","value2","value3","value4","value5","value6","value7","MARCH","edgeTable","clone","lerp","triTable","vertices","Face3","color","Color","randf","faces","faceVertexUvs","Vector2","computeFaceNormals","computeVertexNormals","computeBoundingSphere","MeshLambertMaterial","vertexColors","VertexColors","mesh","Mesh","add","BoxGeometry","MeshBasicMaterial","wireframe","light","DirectionalLight","set","normalize","AmbientLight","PointerLockControls","getObject","enabled","pointerLockElement","requestPointerLock","exitPointerLock","./input","./util",4,"Utility","Math","floor","random","randRange","randArray","arr","perlin","ImprovedNoise"],"mappings":"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","file":"bundle.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","class Input\r\n  constructor: (@domElement = document)->\r\n    @keys = {}\r\n    @listener = {}\r\n\r\n    @keyMap =\r\n      8: 'backspace'\r\n      13: 'enter'\r\n      16: 'shift'\r\n      17: 'ctrl'\r\n      18: 'alt'\r\n      27: 'esc'\r\n      32: 'space'\r\n      37: 'left'\r\n      38: 'up'\r\n      39: 'right'\r\n      40: 'down'\r\n\r\n    mapper = (keycode, status)=>\r\n      key: @keyMap[keycode] or String.fromCharCode(keycode).toLowerCase()\r\n      status: status\r\n\r\n    keydown = Bacon.fromEventTarget(@domElement, 'keydown').map (e)=> mapper.call @, e.keyCode, true\r\n    keyup = Bacon.fromEventTarget(@domElement, 'keyup').map (e)=> mapper.call @, e.keyCode, false\r\n    keydown.merge(keyup).filter (e)->\r\n      code = e.key.charCodeAt 0\r\n      47 < code < 58 or 96 < code < 123\r\n    .onValue (e)=>\r\n      @keys[e.key] = e.status\r\n      return unless e.status \r\n      @listener[e.key]?.forEach (v)-> do v\r\n\r\n    buttons = [THREE.MOUSE.LEFT, THREE.MOUSE.RIGHT]\r\n    \r\n    mouseEvent = (type)=>\r\n      listener = {}\r\n      buttons.forEach (e)-> listener[e] = []\r\n      Bacon.fromEventTarget @domElement, type\r\n        .filter (e)-> e.button in buttons\r\n        .onValue (e)-> listener[e.button].forEach (v)-> v e.clientX, e.clientY\r\n      [ \r\n        (btn, cb)-> listener[btn]?.push cb,\r\n        (btn, cb)-> _.remove listener[btn], (v)-> if cb? then v is cb else true\r\n      ]\r\n\r\n    [@onMouseDown, @offMouseDown] = mouseEvent 'mousedown'\r\n    [@onMouseUp, @offMouseUp] = mouseEvent 'mouseup'\r\n    [@onDoubleClick, @offDoubleClick] = _.transform mouseEvent('dblclick'), (res, e)-> res.push e.bind @, THREE.MOUSE.LEFT\r\n\r\n    [@onMouseMove, @offMouseMove] = do =>\r\n      listener = {}\r\n      active = {}\r\n      buttons.forEach (e)-> \r\n        active[e] = false\r\n        listener[e] = []\r\n      md = Bacon.fromEventTarget(@domElement, 'mousedown').map (e)-> [e.button, true]\r\n      mu = Bacon.fromEventTarget(@domElement, 'mouseup').map (e)-> [e.button, false]\r\n      md.merge(mu).onValue (e)-> active[e[0]] = e[1] if active[e[0]]?\r\n      Bacon.fromEventTarget(@domElement, 'mousemove').onValue (e)->\r\n        for own k, v of listener\r\n          v.forEach (u)-> u e.clientX, e.clientY if active[k] \r\n      [\r\n        (btn, cb)-> listener[btn]?.push cb,\r\n        (btn, cb)-> _.remove listener[btn], (v)-> if cb? then v is cb else true\r\n      ]\r\n\r\n    @offAll = =>\r\n      buttons.forEach (v)=>\r\n        @offMouseDown v\r\n        @offMouseUp v\r\n        @offMouseMove v\r\n      @offDoubleClick()\r\n      @off k for own k, v of @listener\r\n        \r\n\r\n  on: (key, cb)->\r\n    return @listener[key].push cb if @listener[key]\r\n    @listener[key] = [cb]\r\n\r\n  off: (key, cb = allremove)->\r\n    _.remove @listener[key], (v)-> v is cb\r\n\r\n\r\nmodule.exports = Input",null,"'use strict'\r\n\r\nScene = require './scene'\r\n\r\n\r\nclass Main\r\n  constructor: -> \r\n    Detector.addGetWebGLMessage() unless Detector.webgl\r\n\r\n    @renderer = new THREE.WebGLRenderer\r\n        alpha: true\r\n        antialiasing: true\r\n    @renderer.setSize window.innerWidth, window.innerHeight\r\n    @renderer.setClearColor 0xa0d8ef, 1\r\n    @renderer.autoClear = false\r\n    @renderer.sortObjects = true\r\n    $('#world').append @renderer.domElement\r\n\r\n    @currentScene = undefined\r\n    transit = (s)=>\r\n      @currentScene.input.offAll()\r\n      @currentScene = s\r\n\r\n    @currentScene = new Scene @renderer, transit\r\n    \r\n    @stats = new Stats\r\n    @stats.setMode 0  # 0: fps, 1: ms, 2: mb\r\n    @stats.domElement.style.position = 'absolute'\r\n    @stats.domElement.style.left = '0px'\r\n    @stats.domElement.style.top = '0px'\r\n    $(document.body).append @stats.domElement\r\n\r\n    $(window).resize =>\r\n      width = window.innerWidth\r\n      height = window.innerHeight\r\n      @renderer.setSize width, height\r\n      @currentScene.camera.aspect = width / height\r\n      @currentScene.camera.updateProjectionMatrix()\r\n\r\n  animate: ->\r\n    requestAnimationFrame => do @animate\r\n    @stats.begin()\r\n    @renderer.clear()\r\n    @currentScene?.update()\r\n    @stats.end()\r\n\r\n\r\n$ -> do new Main().animate\r\n","util = require './util'\r\nInput = require './input'\r\n\r\nclass Scene\r\n  constructor: (@renderer, @transit)->\r\n    @clock = new THREE.Clock\r\n    @input = new Input document.body\r\n    @scene = new THREE.Scene\r\n    @camera = new THREE.PerspectiveCamera 72, window.innerWidth / window.innerHeight, 1, 1000\r\n    \r\n  update: ->\r\n    @renderer.render @scene, @camera\r\n\r\nclass OrbitScene extends Scene\r\n  constructor: (@renderer, @transit)-> \r\n    super @renderer, @transit\r\n    #@scene.fog = new THREE.Fog 0xffffff, 100, 1000\r\n    @camera.position.z = 100\r\n    @controls = new THREE.OrbitControls @camera\r\n\r\n    @SIZE = 64\r\n    min = -@SIZE / 2\r\n    max = @SIZE / 2 \r\n    range = max - min\r\n\r\n    points = []\r\n    values = []\r\n    hash = util.rand 1000\r\n\r\n    height = []\r\n    hmax = -@SIZE / 2\r\n    hmin = @SIZE / 2\r\n\r\n    do =>\r\n      size = @SIZE * @SIZE\r\n      quality = 2\r\n\r\n      [0...size].forEach (i)-> height.push 0\r\n\r\n      [0...4].forEach (k)=>\r\n        [0...size].forEach (i)=>\r\n          x = i % @SIZE\r\n          z = (i / @SIZE) | 0\r\n          x /= 2\r\n          z /= 2\r\n          height[i] += util.noise(x / quality, z / quality, hash) * quality\r\n        quality *= 4\r\n\r\n      [0...size].forEach (i)-> \r\n        console.log height[i] = -@SIZE / 2 if height[i] < -@SIZE / 2\r\n        console.log height[i] = @SIZE / 2 if height[i] > @SIZE / 2\r\n        height[i] *= 0.5\r\n        hmax = height[i] if height[i] > hmax\r\n        hmin = height[i] if height[i] < hmin\r\n\r\n    [0...@SIZE].forEach (k)=>\r\n      [0...@SIZE].forEach (j)=>\r\n        [0...@SIZE].forEach (i)=>\r\n          x = min + range * i / (@SIZE - 1)\r\n          y = min + range * j / (@SIZE - 1)\r\n          z = min + range * k / (@SIZE - 1)\r\n          points.push new THREE.Vector3(x, y, z)\r\n          value = if height[k*@SIZE + i] > y then height[k*@SIZE + i] + @SIZE / 2  else -1 \r\n          values.push value\r\n   \r\n    size2 = @SIZE * @SIZE\r\n    \r\n    vlist = new Array 12\r\n  \r\n    geometry = new THREE.Geometry()\r\n    vertexIndex = 0\r\n  \r\n    [0...@SIZE-1].forEach (z)=>\r\n      [0...@SIZE-1].forEach (y)=>\r\n        [0...@SIZE-1].forEach (x)=>\r\n          p     = x   + @SIZE * y + size2 * z\r\n          px    = p   + 1\r\n          py    = p   + @SIZE\r\n          pxy   = py  + 1\r\n          pz    = p   + size2\r\n          pxz   = px  + size2\r\n          pyz   = py  + size2\r\n          pxyz  = pxy + size2\r\n    \r\n          value0 = values[p]\r\n          value1 = values[px]\r\n          value2 = values[py]\r\n          value3 = values[pxy]\r\n          value4 = values[pz]\r\n          value5 = values[pxz]\r\n          value6 = values[pyz]\r\n          value7 = values[pxyz]\r\n    \r\n          isolevel = 0\r\n    \r\n          cubeindex = 0\r\n          cubeindex |= 1    if value0 < isolevel\r\n          cubeindex |= 2    if value1 < isolevel\r\n          cubeindex |= 8    if value2 < isolevel\r\n          cubeindex |= 4    if value3 < isolevel\r\n          cubeindex |= 16   if value4 < isolevel\r\n          cubeindex |= 32   if value5 < isolevel\r\n          cubeindex |= 128  if value6 < isolevel\r\n          cubeindex |= 64   if value7 < isolevel\r\n    \r\n          bits = MARCH.edgeTable[cubeindex]\r\n    \r\n          return if bits is 0\r\n    \r\n          mu = 0.5 \r\n    \r\n          if bits & 1\r\n            mu = (isolevel - value0) / (value1 - value0)\r\n            vlist[0] = points[p].clone().lerp points[px], mu\r\n          if bits & 2\r\n            mu = (isolevel - value1) / (value3 - value1)\r\n            vlist[1] = points[px].clone().lerp points[pxy], mu\r\n          if bits & 4\r\n            mu = (isolevel - value2) / (value3 - value2)\r\n            vlist[2] = points[py].clone().lerp points[pxy], mu\r\n          if bits & 8\r\n            mu = (isolevel - value0) / (value2 - value0)\r\n            vlist[3] = points[p].clone().lerp points[py], mu\r\n          if bits & 16\r\n            mu = (isolevel - value4) / (value5 - value4)\r\n            vlist[4] = points[pz].clone().lerp points[pxz], mu\r\n          if bits & 32\r\n            mu = (isolevel - value5) / (value7 - value5)\r\n            vlist[5] = points[pxz].clone().lerp points[pxyz], mu\r\n          if bits & 64\r\n            mu = (isolevel - value6) / (value7 - value6)\r\n            vlist[6] = points[pyz].clone().lerp points[pxyz], mu\r\n          if bits & 128\r\n            mu = (isolevel - value4) / (value6 - value4)\r\n            vlist[7] = points[pz].clone().lerp points[pyz], mu\r\n          if bits & 256\r\n            mu = (isolevel - value0) / (value4 - value0)\r\n            vlist[8] = points[p].clone().lerp points[pz], mu\r\n          if bits & 512\r\n            mu = (isolevel - value1) / (value5 - value1)\r\n            vlist[9] = points[px].clone().lerp points[pxz], mu\r\n          if bits & 1024\r\n            mu = (isolevel - value3) / (value7 - value3)\r\n            vlist[10] = points[pxy].clone().lerp points[pxyz], mu \r\n          if bits & 2048 \r\n            mu = (isolevel - value2) / (value6 - value2)\r\n            vlist[11] = points[py].clone().lerp points[pyz], mu\r\n          \r\n          i = 0\r\n          cubeindex <<= 4\r\n          \r\n          until MARCH.triTable[cubeindex + i] is -1 \r\n            index1 = MARCH.triTable[cubeindex + i]\r\n            index2 = MARCH.triTable[cubeindex + i + 1]\r\n            index3 = MARCH.triTable[cubeindex + i + 2]\r\n            \r\n            geometry.vertices.push vlist[index1].clone()\r\n            geometry.vertices.push vlist[index2].clone()\r\n            geometry.vertices.push vlist[index3].clone()\r\n            face = new THREE.Face3 vertexIndex, vertexIndex + 1, vertexIndex + 2\r\n            face.color = new THREE.Color(0, 0.5 + util.randf(0.5), 0)\r\n            #face.vertexColors[0] = new THREE.Color 0x000ff\r\n            #face.vertexColors[1] = new THREE.Color 0x00ff00\r\n            #face.vertexColors[2] = new THREE.Color 0x0000ff\r\n            geometry.faces.push face\r\n            geometry.faceVertexUvs[0].push [new THREE.Vector2(0, 0), new THREE.Vector2(0, 1), new THREE.Vector2(1, 1)]\r\n            vertexIndex += 3\r\n            i += 3\r\n    \r\n    geometry.computeFaceNormals()\r\n    geometry.computeVertexNormals()\r\n    geometry.computeBoundingSphere()\r\n\r\n    material = new THREE.MeshLambertMaterial\r\n        #color: 0x00cc33\r\n        #side: THREE.DoubleSide\r\n        vertexColors: THREE.VertexColors\r\n    @mesh = new THREE.Mesh geometry, material\r\n    @scene.add @mesh\r\n\r\n    bgeometry = new THREE.BoxGeometry @SIZE, hmax - hmin, @SIZE\r\n    bmaterial = new THREE.MeshBasicMaterial\r\n        color: 0x00ffff\r\n        wireframe: true\r\n    bmesh = new THREE.Mesh bgeometry, bmaterial\r\n    @scene.add bmesh\r\n    bmesh.position.y += (hmax + hmin)/2\r\n    \r\n    @light = new THREE.DirectionalLight 0xffffff, 1.0\r\n    @light.position.set(0.5, 0.7, 0.3).normalize()\r\n    @scene.add @light\r\n\r\n    @scene.add new THREE.AmbientLight 0x202020\r\n\r\n    #@input.onMouseDown THREE.MOUSE.RIGHT, =>\r\n    #  console.log \"transit PLScene\"\r\n    #  @transit new PLScene @renderer, @transit\r\n\r\n\r\n  update: ->\r\n    @controls.update()\r\n    super()\r\n    \r\n\r\nclass PLScene extends Scene\r\n  constructor: (@renderer, @transit)-> \r\n    super @renderer, @transit\r\n    @camera.position.z = 100\r\n    @controls = new THREE.PointerLockControls @camera\r\n    @scene.add @controls.getObject()\r\n\r\n    geometry = new THREE.BoxGeometry 20, 20, 20\r\n    material = new THREE.MeshBasicMaterial\r\n        color: 0xff0000\r\n        wireframe: true\r\n    @mesh = new THREE.Mesh geometry, material\r\n    @scene.add @mesh\r\n\r\n    @input.onMouseDown THREE.MOUSE.LEFT, =>\r\n      console.log \"poyo\"\r\n      @controls.enabled = true\r\n      unless document.pointerLockElement\r\n        document.body.requestPointerLock()\r\n    \r\n    @input.onDoubleClick =>\r\n      @controls.enabled = false\r\n      if document.pointerLockElement\r\n        document.exitPointerLock()\r\n      console.log \"transit OrbitScene\"\r\n      @transit new OrbitScene @renderer, @transit\r\n      \r\n\r\nmodule.exports = OrbitScene","class Utility\r\n  @rand = (n)->\r\n    Math.floor Math.random() * n\r\n\r\n  @randf = (n)->\r\n    Math.random() * n\r\n\r\n  @randRange = (min, max)->\r\n    Math.floor(Math.random() * (max - min + 1)) + min\r\n  \r\n  @randArray = (arr)->\r\n    arr[Math.floor Math.random() * arr.length]\r\n\r\n  @noise = do ->\r\n    perlin = new ImprovedNoise\r\n    (x, y, z)-> perlin.noise x, y, z\r\n\r\n\r\nmodule.exports = Utility"],"sourceRoot":"./src"}